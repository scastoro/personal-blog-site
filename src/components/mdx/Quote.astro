---
export interface Props {
  author?: string;
  source?: string;
  sourceUrl?: string;
  cite?: string;
  variant?: 'default' | 'large' | 'pullquote';
}

const { author, source, sourceUrl, cite, variant = 'default' } = Astro.props;

const variantClasses = {
  default: {
    container: 'my-6 pl-4 border-l-4 border-blue-500',
    quote: 'text-lg text-gray-700 dark:text-gray-300 italic',
    attribution: 'mt-2 text-sm text-gray-600 dark:text-gray-400'
  },
  large: {
    container: 'my-8 text-center',
    quote: 'text-2xl md:text-3xl text-gray-800 dark:text-gray-200 font-light leading-relaxed',
    attribution: 'mt-4 text-base text-gray-600 dark:text-gray-400'
  },
  pullquote: {
    container: 'my-8 mx-4 p-6 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700',
    quote: 'text-xl text-gray-800 dark:text-gray-200 font-medium text-center',
    attribution: 'mt-4 text-sm text-gray-600 dark:text-gray-400 text-center'
  }
};

const classes = variantClasses[variant];
---

<blockquote class={classes.container} cite={cite}>
  {variant === 'large' && (
    <div class="text-6xl text-blue-500 dark:text-blue-400 mb-4" aria-hidden="true">
      "
    </div>
  )}
  
  <div class={classes.quote}>
    {variant !== 'large' && (
      <span class="text-2xl text-blue-500 dark:text-blue-400 mr-1" aria-hidden="true">"</span>
    )}
    <slot />
    {variant !== 'large' && (
      <span class="text-2xl text-blue-500 dark:text-blue-400 ml-1" aria-hidden="true">"</span>
    )}
  </div>
  
  {variant === 'large' && (
    <div class="text-6xl text-blue-500 dark:text-blue-400 mt-4" aria-hidden="true">
      "
    </div>
  )}
  
  {(author || source) && (
    <footer class={classes.attribution}>
      <cite>
        {author && (
          <span class="font-medium">â€” {author}</span>
        )}
        {source && (
          <span>
            {author && ', '}
            {sourceUrl ? (
              <a 
                href={sourceUrl} 
                class="text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 underline transition-colors"
                target="_blank"
                rel="noopener noreferrer"
              >
                {source}
              </a>
            ) : (
              source
            )}
          </span>
        )}
      </cite>
    </footer>
  )}
</blockquote>

<style>
  /* Enhanced quote styling */
  blockquote {
    position: relative;
  }
  
  /* Pullquote specific styling */
  .pullquote::before,
  .pullquote::after {
    content: '"';
    position: absolute;
    font-size: 4rem;
    color: theme('colors.blue.500');
    font-family: Georgia, serif;
    line-height: 1;
  }
  
  .pullquote::before {
    top: -0.5rem;
    left: 1rem;
  }
  
  .pullquote::after {
    bottom: -2rem;
    right: 1rem;
  }
  
  /* Responsive adjustments */
  @media (max-width: 640px) {
    .text-2xl.md\:text-3xl {
      font-size: 1.5rem;
      line-height: 2rem;
    }
    
    .text-6xl {
      font-size: 3rem;
    }
  }
  
  /* Animation for large quotes */
  @media (prefers-reduced-motion: no-preference) {
    blockquote {
      animation: fadeInUp 0.6s ease-out;
    }
  }
  
  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
</style>